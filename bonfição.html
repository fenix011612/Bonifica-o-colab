<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Controle Financeiro Yoga</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
    font-family:Arial, sans-serif;
    background:#f3e9ff;
    margin:0;
}
header{
    background:linear-gradient(45deg,#a66bff,#40c8ff);
    color:white;
    text-align:center;
    padding:20px;
    font-size:24px;
    font-weight:bold;
}
.container{
    width:96%;
    max-width:900px;
    background:white;
    margin:25px auto;
    padding:20px;
    border-radius:15px;
    box-shadow:0 0 12px #00000022;
}
label{
    font-weight:bold;
    margin-top:10px;
    display:block;
}
input,select{
    width:100%;
    padding:8px;
    margin-top:5px;
    border-radius:8px;
    border:1px solid #999;
}
button{
    margin-top:15px;
    width:100%;
    padding:10px;
    background:#8f57ff;
    border:none;
    color:white;
    border-radius:8px;
    font-size:16px;
    cursor:pointer;
}
button:hover{background:#7d4ceb;}

.resumo{
    display:flex;
    gap:10px;
    margin-top:20px;
    flex-wrap:wrap;
}
.card{
    flex:1;
    padding:15px;
    border-radius:12px;
    text-align:center;
    font-weight:bold;
}
.entrada{background:#d4f7dc;color:#136b2f;}
.saida{background:#ffd6d6;color:#8b1e1e;}
.saldo{background:#e0d9ff;color:#3a2f8f;}

table{
    width:100%;
    border-collapse:collapse;
    margin-top:20px;
}
th,td{
    padding:10px;
    border-bottom:1px solid #ddd;
}
th{
    background:#a66bff;
    color:white;
}
.delete{
    background:#ff4d4d;
    border:none;
    color:white;
    padding:5px 8px;
    border-radius:6px;
    cursor:pointer;
}
</style>
</head>

<body>

<header>Controle de Entradas e Sa√≠das - Yoga</header>

<div class="container">

<label>M√™s:</label>
<select id="mes"></select>

<label>Tipo:</label>
<select id="tipo" onchange="atualizarLabel()">
    <option value="yoga">Yoga (Entrada)</option>
    <option value="lojinha">Lojinha (Entrada)</option>
    <option value="prof">Pagamento Professores (Sa√≠da)</option>
</select>

<label id="labelNome">Nome do aluno:</label>
<input id="nomePessoa">

<label>Forma de pagamento:</label>
<select id="pagamento">
    <option>Pix</option>
    <option>Dinheiro</option>
</select>

<label>Descri√ß√£o:</label>
<input id="descricao">

<label>Valor R$:</label>
<input id="valor" type="number">

<button id="btnAdd">Adicionar</button>

<div class="resumo">
    <div class="card entrada">Entradas<br>R$ <span id="totalEntrada">0</span></div>
    <div class="card saida">Sa√≠das<br>R$ <span id="totalSaida">0</span></div>
    <div class="card saldo">Saldo<br>R$ <span id="saldo">0</span></div>
</div>

<table>
<thead>
<tr>
    <th>Tipo</th>
    <th>Nome</th>
    <th>Pagamento</th>
    <th>Descri√ß√£o</th>
    <th>Valor</th>
    <th>Data</th>
    <th>Excluir</th>
</tr>
</thead>
<tbody id="tabela"></tbody>
</table>

</div>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import {
  getFirestore, collection, addDoc,
  getDocs, deleteDoc, doc
} from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

// üî• CONFIG QUE VOC√ä MANDOU
const firebaseConfig = {
  apiKey: "AIzaSyDyD1PIfduFrLl-vXlBVisZFirQ3iKi2vI",
  authDomain: "yoga-4abef.firebaseapp.com",
  projectId: "yoga-4abef",
  storageBucket: "yoga-4abef.firebasestorage.app",
  messagingSenderId: "217283131263",
  appId: "1:217283131263:web:0431c954294ce56d7ecc4a"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// ===== MESES =====
const meses=["Janeiro","Fevereiro","Mar√ßo","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"];
const mesSel=document.getElementById("mes");

meses.forEach(m=>{
    let o=document.createElement("option");
    o.value=m;
    o.textContent=m;
    mesSel.appendChild(o);
});
mesSel.value=meses[new Date().getMonth()];
mesSel.onchange=carregar;

window.atualizarLabel = function(){
    const tipo=document.getElementById("tipo").value;
    const label=document.getElementById("labelNome");
    if(tipo==="yoga") label.textContent="Nome do aluno:";
    else if(tipo==="prof") label.textContent="Nome do professor:";
    else label.textContent="Nome / Refer√™ncia:";
}

// ===== ADD =====
document.getElementById("btnAdd").onclick = async () => {
    const tipo=document.getElementById("tipo").value;
    const movimento = (tipo==="prof") ? "saida" : "entrada";

    await addDoc(collection(db,"movimentacoes",mesSel.value,"itens"),{
        tipo,
        movimento,
        nome:nomePessoa.value,
        pagamento:pagamento.value,
        descricao:descricao.value,
        valor:Number(valor.value),
        data:new Date().toLocaleString("pt-BR")
    });

    nomePessoa.value="";
    descricao.value="";
    valor.value="";
    carregar();
};

// ===== LISTAR =====
async function carregar(){
    const tb=document.getElementById("tabela");
    tb.innerHTML="";
    let ent=0, sai=0;

    const snap = await getDocs(collection(db,"movimentacoes",mesSel.value,"itens"));
    snap.forEach(d=>{
        const e=d.data();
        e.movimento==="entrada"? ent+=e.valor : sai+=e.valor;

        tb.innerHTML+=`
        <tr>
            <td>${e.movimento==="entrada"?"Entrada":"Sa√≠da"}</td>
            <td>${e.nome}</td>
            <td>${e.pagamento}</td>
            <td>${e.descricao}</td>
            <td>R$ ${e.valor.toFixed(2)}</td>
            <td>${e.data}</td>
            <td><button class="delete" onclick="excluir('${d.id}')">X</button></td>
        </tr>`;
    });

    totalEntrada.textContent=ent.toFixed(2);
    totalSaida.textContent=sai.toFixed(2);
    saldo.textContent=(ent-sai).toFixed(2);
}

window.excluir = async (id)=>{
    await deleteDoc(doc(db,"movimentacoes",mesSel.value,"itens",id));
    carregar();
};

carregar();
</script>

</body>
</html>
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Ranking de Bonifica√ß√£o</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
    font-family: Arial, sans-serif;
    background:#f4f4f4;
    padding:20px;
}
.container{max-width:1200px;margin:auto;}
header{
    background:#6a5acd;
    color:#fff;
    padding:15px;
    border-radius:8px;
    margin-bottom:15px;
}
button{
    padding:6px 12px;
    border:none;
    border-radius:6px;
    background:#6a5acd;
    color:#fff;
    cursor:pointer;
    font-weight:bold;
}
button.sec{background:#999;}
button.danger{background:#c0392b;}
input,select{padding:6px;width:100%;}
table{width:100%;border-collapse:collapse;margin-top:10px;}
th,td{border:1px solid #ccc;padding:8px;text-align:left;}
th{text-align:center;background:#eee;}
.form{background:#fff;padding:15px;border-radius:8px;margin-top:15px;}
.hidden{display:none;}
.valor{font-weight:bold;color:green;}
.topo{display:flex;justify-content:space-between;align-items:center;}
</style>
</head>

<body>

<div class="container">
<header>
    <h2>Ranking de Bonifica√ß√£o Semestral</h2>
</header>

<button onclick="novoColaborador()">+ Novo colaborador</button>

<table id="ranking">
<thead>
<tr>
    <th>#</th>
    <th>Colaborador</th>
    <th>Pontua√ß√£o</th>
    <th>%</th>
    <th>Bonifica√ß√£o</th>
    <th>A√ß√£o</th>
</tr>
</thead>
<tbody></tbody>
</table>

<div class="form hidden" id="form">
    <div class="topo">
        <h3>Avalia√ß√£o de <span id="nomeAtual"></span></h3>
        <button class="sec" onclick="fechar()">‚úñ Fechar</button>
    </div>

    <label>Nome do colaborador</label>
    <input id="nome" oninput="atualizarNome()">

    <label>M√©dia salarial (6 meses)</label>
    <input type="number" id="salario" oninput="calcular()">

    <h4>Crit√©rios de Avalia√ß√£o</h4>
    <table>
        <thead>
            <tr>
                <th>Crit√©rio</th>
                <th>Avalia√ß√£o</th>
            </tr>
        </thead>
        <tbody id="criterios"></tbody>
    </table>

    <button onclick="salvar()">Salvar avalia√ß√£o</button>

    <h4>Hist√≥rico do colaborador</h4>
    <table>
        <thead>
            <tr>
                <th>Data</th>
                <th>Pontua√ß√£o</th>
                <th>%</th>
                <th>Valor</th>
                <th>A√ß√£o</th>
            </tr>
        </thead>
        <tbody id="historico"></tbody>
    </table>
</div>
</div>

<script>
const criteriosLista = [
 "Meta Financeira ‚Äì Redu√ß√£o de custos",
 "Meta Qualidade ‚Äì Satisfa√ß√£o do cliente",
 "Meta Planejamento ‚Äì Conclus√µes di√°rias",
 "Meta Produtividade ‚Äì Fideliza√ß√£o/capta√ß√£o",
 "Qualidade do Trabalho",
 "Produtividade",
 "Trabalho em Equipe",
 "Criatividade",
 "Alinhamento, Cultura e Valores",
 "Assiduidade e Pontualidade"
];

let colaboradores=[];
let atual=null;

function novoColaborador(){
 colaboradores.push({
  nome:"Colaborador "+(colaboradores.length+1),
  salario:0,
  historico:[],
  pont:"0%",
  perc:"0%",
  valor:"R$ 0,00"
 });
 atualizarRanking();
}

function atualizarRanking(){
 const tbody=document.querySelector("#ranking tbody");
 tbody.innerHTML="";
 colaboradores
 .sort((a,b)=>parseFloat(b.valor.replace(/\D/g,''))-parseFloat(a.valor.replace(/\D/g,'')))
 .forEach((c,i)=>{
  tbody.innerHTML+=`
   <tr>
    <td>${i+1}</td>
    <td>${c.nome}</td>
    <td>${c.pont}</td>
    <td>${c.perc}</td>
    <td class="valor">${c.valor}</td>
    <td><button onclick="avaliar(${i})">Avaliar</button></td>
   </tr>`;
 });
}

function avaliar(i){
 atual=i;
 const c=colaboradores[i];
 form.classList.remove("hidden");
 nome.value=c.nome;
 salario.value="";
 nomeAtual.textContent=c.nome;

 criterios.innerHTML="";
 criteriosLista.forEach(cr=>{
  criterios.innerHTML+=`
   <tr>
    <td>${cr}</td>
    <td>
     <select onchange="calcular()">
      <option value="0">N√£o atingiu</option>
      <option value="50">Parcial</option>
      <option value="100">Atingiu</option>
     </select>
    </td>
   </tr>`;
 });

 renderHistorico();
}

function renderHistorico(){
 const c=colaboradores[atual];
 historico.innerHTML = c.historico.length
 ? c.historico.map((h,i)=>`
   <tr>
    <td>${h.data}</td>
    <td>${h.pont}</td>
    <td>${h.perc}</td>
    <td>${h.valor}</td>
    <td>
      <button class="danger" onclick="excluirRegistro(${i})">Excluir</button>
    </td>
   </tr>`).join("")
 : `<tr><td colspan="5" style="text-align:center">Sem hist√≥rico</td></tr>`;
}

function excluirRegistro(index){
 if(confirm("Deseja excluir este registro do hist√≥rico?")){
  colaboradores[atual].historico.splice(index,1);
  renderHistorico();
 }
}

function atualizarNome(){
 colaboradores[atual].nome=nome.value;
 nomeAtual.textContent=nome.value;
 atualizarRanking();
}

function calcular(){
 const selects=document.querySelectorAll("#criterios select");
 let soma=0;
 selects.forEach(s=>soma+=parseInt(s.value));
 const pont=((soma/(criteriosLista.length*100))*100).toFixed(1);

 let perc=0;
 if(pont>=50&&pont<75) perc=25;
 else if(pont>=75&&pont<100) perc=33;
 else if(pont==100) perc=50;

 const sal=parseFloat(salario.value)||0;
 const valor=(sal*(perc/100)).toLocaleString("pt-BR",{style:"currency",currency:"BRL"});

 Object.assign(colaboradores[atual],{
  salario:sal,
  pont:pont+"%",
  perc:perc+"%",
  valor
 });

 atualizarRanking();
}

function salvar(){
 const c=colaboradores[atual];
 c.historico.push({
  data:new Date().toLocaleDateString("pt-BR"),
  pont:c.pont,
  perc:c.perc,
  valor:c.valor
 });
 renderHistorico();
 resetar();
 alert("Avalia√ß√£o salva");
}

function resetar(){
 salario.value="";
 document.querySelectorAll("#criterios select").forEach(s=>s.value="0");
}

function fechar(){
 form.classList.add("hidden");
 atual=null;
}
</script>

</body>
</html>
